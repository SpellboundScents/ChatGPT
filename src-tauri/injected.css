/* ===== Chat content scope ===== */
.nick-scope { line-height: 1.35; }

/* --- Code blocks (normalized) --- */
.nick-scope pre.nick-code {
  display: block;
  overflow-x: auto;
  overflow-y: visible;
  white-space: pre;
  word-break: normal;
  margin: .55rem 0;
  padding: .75rem 1rem;
  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
  background: color-mix(in srgb, currentColor 6%, transparent);
  border: 1px solid color-mix(in srgb, currentColor 12%, transparent);
  border-radius: .5rem;
}

.nick-scope pre.nick-code > code {
  display: block;
  min-width: 100%;
  white-space: inherit; /* inherit from pre */
}

/* Modest gap after code blocks */
.nick-scope pre.nick-code + * { margin-top: .4rem; }

/* --- General text spacing --- */
.nick-scope p { margin: .45rem 0; }
.nick-scope ul,
.nick-scope ol { margin: .55rem 1.25rem; }

/* --- Inline citations / superscripts stay inline and compact --- */
.nick-scope a.citation,
.nick-scope span.citation,
.nick-scope span[data-citation],
.nick-scope .oaicite,
.nick-scope sup,
.nick-scope .citation,
.nick-scope .citation * {
  display: inline;
  white-space: normal;
  line-height: 1;
  margin: 0;
  padding: 0;
}

/* --- Inline code (not inside PRE) wraps nicely --- */
.nick-scope :not(pre) > code {
  white-space: normal;
  word-break: break-word;
  overflow: visible;
  padding: .1em .25em;
  border-radius: .2em;
  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
  background: color-mix(in srgb, currentColor 10%, transparent);
}

/* --- Images defensive sizing --- */
.nick-scope img { max-width: 100%; height: auto; display: inline-block; }

/* --- Safari/iOS momentum scrolling only when relevant --- */
@supports (-webkit-overflow-scrolling: touch) {
  .nick-scope pre.nick-code { -webkit-overflow-scrolling: touch; }
}

/* Optional: “message” containers for virtualization / content-visibility later */
.nick-scope .msg {
  /* We’ll turn this on in a later step when we virtualize long chats */
  /* content-visibility: auto; */
  /* contain-intrinsic-size: 300px; */
}
/* drop this into your injected.css */
.nick-scope .msg {
  content-visibility: auto;
  contain-intrinsic-size: 320px; /* tune: typical message height guess */
  padding-block: .25rem;         /* keeps small breathing room */
}
